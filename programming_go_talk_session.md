# プログラミング Go トークセッション

Go の設計思想を読み解く

うかいふみとし
しばたよしき

設計思想
 色濃く出ている
   できるだけ簡潔にコードをかける
    巨大なぷらダクトとしてくみ上げる
    本で書いてあるといえば スライスの比較
      配列はイコール、スライスは実質ポインタ
       同一性の定義は難しい、しゃろーな\比較、名k実を比較
        ほかの言語ならどちらか、療法、 GO は比較を禁止、専用の関数を用意
         あいまいな記述をできるだけさせないようにしている
       見てないとこrのの影響をなるべくおさえる
        おおきいプロダクトで有効
         レビューは普通は IDFF しかみない
          PYTHON だとかだと DIFF を見てもわからない こーどれby－が難しくなる
         結局テストにたよ
         GOは見ただけでまずいコードがわかりやすい （なれてくれば
          レビューの時に見ているところだけでまずいコードと判断しやすい
        もう一つのれい
         GOROUTINE ID がない
          普通スレッドだと スレッドIDやスレッドローカルストr－江地 ￥
           スレッドでだけみえるものを用意 普通の言語
         GO では提供していない
          出すことによって、コードパスが読みにくくなる
           単におr－借るか、スレッドローカルなのかがわかり居づらくなる恐れがある
           GORUOUTIEN は気軽におこせるのでしょっちゅうわからなくなる
            GROUTINE がどこか意識して書かせたくない
        GOROUTINE のはなしはちゃんと本にかいてある。
         IDをもたない理由
         チャネル が 言語使用に入っている
          組み込みだと複雑なロジックにしないため、伊bンととタスクを用意することがおおい
           それですいっちする
         チャネルだとセレクトでうまくさばける
         スタックオーバーフローしないのに驚いた
          前に再起関数を書いたときにもスタックオーバーフローが起きなかった
        継承がない
         COMPOSITIONしかない
          あるいみ設計を制限、というかある範囲に抑えているのが特徴的
        できるけどやらない
         ７勝インターフェースの
          インターフェース設計の優れた、、、、

     オブジェクト指向に対して
      GO で書くときはまず具象型できちんとAPIを考える。でほかの言語から来た人はインターフェースからかいてしまう
       GOではそれはよくにあ。GOらしくない
       インターフェースは後で必要な人が定義するので十分。具体的なオブジェt区とがどう動くかは具象型でちゃんと決める
        共通点を見つけ出してからインターフェースでくくりだすのがGOらしい
         これも本に書いてあった
         早すぎた抽象化はさけるべき。後で間違っていたとわかったときには大きなへんこうになる。
     249ページにちょっとした助言として描かれている
       JAVAとかだとインターフェースを考えて志う。
        GOだと具象型からになる。問題を解くというのが先
        usirono hounga\omosiroi
         sekkeikara ikutoiuyoriha tukurinagara,naosinagaartoiukannjiwo syokennkara uketa

      今までのプログラミング言語と違ったところは？
        GOは必要最小限なものしかないように見える
         ほかの言語だと思いテストフレームワークがあったりする
        GOでは必要最小限んだけやって、普通のコードを加工というはんしになる
      ほかのフレームワークと比較すると何もないように見える
       通常はテストのフレームワークを覚えたいとテストできない。
        GOはテストフレームくぁーくで覚えるところがないので楽にできる


    GOを始めたころの印象
   うかい
     GOはパッケージが非常にちゃんとしていて便利なものがたくさんあった。最初のころは上手な使い方が泣かんかみつけられなかった
     単一のパッケージを使うのはまだまだ。インターフェースで複数のパッケージを組み合わせて使うと非常に複雑なことができる
      特にIO関係のインターフェースとか
       IO は ファイルバッファとかいろいろ複雑なことができることを見いだせる
        そういう設計ができれば非常にGOらいしい
        はあまり安いところは変数のスコープと車道ははまりやすい
         LOOP変数のキャプチャはみんあはまると思おう
          ループをGOROUTINEにあｗたして最後のしかじっこうされないなーとか
          すれ椅子もわかりづあらい？ポインタと思って使うとひょい
          ほかにはまるのは
           NILの扱い。NILポインタとNILのインターフェースが違うのは結構はまりやすい
           INTERFACE のNILは二つのポインタ 値ンおポインタと肩のポインタ
           型のポインタは決まっている。インターフェースに突っ込むと値はNILでなくなってしまって不思議だなとなる
           C++datoオブジェクトがNILだとメソッド呼べないというのがある GOはレシーバーがｎILでも普通にメソッドよべっる
           メソッドに\レシーバと引数がわたっているだけ
            レシーバがNILの時にデフォルトの同左をするGOR\頼しいコードになる
            うまくやると初期化とかきれいに変えkる
   しばｇた
    昔はビルドが謎のコマンドでくろうした
     はまるのは スライス。
       三つのフィールドを持った構造体と考えいるのがよい
      インターフェースがNIL比較をしようとしたときにNILでないと比較が成田田t内というケースがよくある 自分もはまった
       そもそもなぜそういうしようなのか？おそらくNILでもメソッドが呼べるというのが、インターフェースが型と値を持っているのも出、
       型があれば呼べるかもしれないというのがきている。
        なぜNI比較できないあというのはあっ
      変数のスコープが補完尾言語から見るとえっとなるのがある
       X :+ Xというのが￥あったり
        GOだとローカル変数を作ってパラメータの値を代入している
         ローカル変数をGOROUTINEに渡すと最後だけ反映していいる。なんでというのがある
         変数のスコープだけ言あh￥わかりづありあ
         コロンイコールで宣言と同時に代入。左辺に二つの以上の変数があったら、一つでも未定義のがあればいい、というはまりどころがある
       昔は結構パッケージのインターフェースがよく変わっていた。
        勉強会のネタでプログラムを阿多rしいバージョンでやるというのをやっていたり
        かなり書いていると青の機能がどこそおにあるというのを決行書いていると覚えるが、
        慣れていない頃はどこいなるかがわかりづらい
        JACAだと度のインターフェースを実装しているかわかりやすいが、GOだとわかりづらい
        GOだとどうよやるか？
         GODOC で性的に解析s手そういうのがわかるようなドキュメントをつかうのがよい

     ループ変数、無名関数の補足 DEFFER で呼び出す遅延関数呼び出し
     このあたりの話の運びが非常にうまい
      さすがカーに範という感じ

    GOが向いてそうな分野
     うかい
       もともと OGはGOOGLえのサーバを記述すするのにむけてつくられた
        あのてのWEBサーバとかを角煮に非常に簡単になっている
        C++datoスレッドどうするかとかコードを改定いかないといけないが、GOだと非常に気楽にかける
        逆にそういうのがない分野だとそこまでよいわけではない
        経験した例で言うと、GNU MAKE FILE をパースシテ変換するというのは
        パースシテトークン作って評価するというのはCONCURRENCYないし、GCが結構ネックになってきていて、それくらいの処理になると自分でメモリ管理しやすいCのほうが割とかける
        ただそれをもとにおもっと大きいのを書こうとしたときに、並列にさせたり、ほかの処理もさせたりするのはCだと難しい
        GOだとそもままパット埋め込めるようにできる
        複雑になればなるほどGOのほうが有利になってくる
        今はGO自体がGOで書かれているが、遅くなってしまった
        最初はCで書いたほうがはｙくはなる
        Gで書くのはGOのツールが使いやすいプロファイルとかつかえるし、無駄なコードがなくなる今カレンシーが\使える
        これからの改善だとGOでいい。システムプログラミングでそういうのが日宇町ないのであればCでもいい

    しばｇた
     どちらかというと複写機のソフトを書くお時に1000万行を超えるコードをかくが
      メモリ管理が大変だった。
      もうひとつはどうつくるか。選択によっては何度が非常に上がる
       JAVA de並列をオブジェクトでやろうとすると、ty何と設計できるひとがいない
        イベントループするというのがシンプルにできるのでそう負いウイ設計には GO なんかが向いている
        実際どれくらいの規模ができるのは詳しく言えないが、大きい規模でそれなりに書くことができる
      こんごWEB系でGOROUTINの軽さが注目されている。組み込み系でももう少し使われてもいいかなとおもう
       ただしGC系のgン語なのでメモリがそれほど触れないのでチューニングがどれくらいできるかというのがそれほどむいていないのかもしれない
        経験上ではそこで問題になうりょうなことはそんなになかった。
        今後はもうちょっとWEB系だけでなくてk8宇見込みとかそういう言うとここrで改善点と広まればいいかなというかんじ

      今年はGOの本がいろいろ出ている

   GOにキラーアプリがでるのか
     うかい
       キラーアプリは思いつかない
        キラーアプリがあるのはいいのかどうか？
         キラーアプリの主変は盛り上がるが、そのほかが甘くなりがち
          いろんな分野のっ専門家がいろんなパッケージを提供するのがいいんじゃないか
           いろんな分野で使われるのがいいかともおている
     しばた
      キラーアプリはもうでてこないのではないかともおう
       今はGOROUTINEの軽さでWEB系で使われているが、ほかのいろんなところでも使われていくんじゃないかと思う

Cと比べてどうか？
 うかい
   関係にコードが欠けるというのは引き継いでいる。意図通りのコードが欠けるのは引き継いでいる
    Cno場合はOSを作る」目的があってCPUとかデバイスとかを直接させ割るのに必要が効こうがあったりした
   GOでもやろうと思えばアセンブリ使ったりUNSAFEをうまく使ったりすることができる敷居は高い
    メモリ管理もChaじぶんでやうｒものだが、GOはGCまかせ
      ただしGCがすべてを解決してくれるwかけではなくて、危ない点をどうにあかしてくれるだけ
        うまくやらないとメモリを馬鹿に食ってしまう。意識して書かないとパフォーマンスが越智りう
       Ckarakitara NEW あとヒープ、普通に宣言するとローカルになる と思いがち
        GOあとそこはコンパイラが判断する。エスケープできればヒープ？ ここらへんよくわかならい
        メソッドたどってエスケープしないのが明らかに見えても判断を間違えるのがあり、うまく書くのは難しい
    GOではシンプリシティが非常に重要視されている。GCも単純さを提供している
     実際にバックヤードでは非常に複座うtなことをしている
      シンプルなインターフェースを提供するために難しいことをしている
  しばた
   若干先祖返りした感じはある
   いいとこどりをしてコンパクトを￥にまとめているので交換が持てる

 おすすめの開発スタイル、今後どいう言う影響おw与えていくか
  うかい
    GOはIDみIDEみたいなものを提供してない、代わりにツールを提供していて自分の好きなエディターに組み込めるようにしている
    GOで大きなプロジェクトを作っていくと、ちゃんとしたベストプラクティスがまだ確立されていないというのあは感じる
   同\レンダリングするのがいいかとかよくわからない。まだGOGEとでとってきて使うのがいいとは思う
   GO の開発チームが作っているのはリビジョンによって全然会話ることはそうそうないが、ちょっと離れっるとGOOGLEのGRPCライブ拉致とかプロトコルバッファとかもバージョンを上げないといけなくて
   頑張って追いかけるか、うまくペンだリングすることを考えるか選択しないといけない
   しばた
     IDE JAVAのときは IDEでリファクタリングするのがよいとしていたが、
     GO だとIVMに戻った
      ツールの使いようは試行錯誤しながらになっている
    今までと大きく違うのはGOFMTが標準でついている
     フォーマッタがついているのはチーム内でインデント論争がほとんどない
      絵知恵xたーで書いているときに適当なとこから書いていてもきれいにおf－真っとしているので、ほかの言語にも入れてほしいくらい


質問
 GO言語でバイナリの扱いとかで運用面はどのようなかんじになるか
   バイナリは一つにくっつけるとか
   運用的な苦労とか新しいことが見つかったりしているか

    A デフォルトすたちっくバイナリにしているのは簡単だからしているだけという印象がある。バイナリパッケージ、っしえ亜土ライブラリを導入するという話もある
     どちらかというと使ってみたら一つのバイナリにするのが楽という感じだった
      コンテナとかあとひしぇあどオブj九会おtにする必要はないので、たまたまいい感じにっはまった印象がる

Q 機械学習に対して、GOで機械学習のライブラリが増えるか？
  A うかい GOだと演算子のオーバーローディングと化できないのt向いていない面はあ￥る
         使う人次第。

Q GO でリクエストを受けてレスポンスを返すという処理を書いていた。アクセスが集中したときに、APIサーバの処理は問題ないが、リソースをくいつぶしてしまたｔ GOROUTINEのリソース管理はどのような方法があるか。
A 係数セマフォを決めておいてバックエンドがっさばける量を決めておいて、んｎ
  おーばおーロードしたときはかすけーディングフェイラーを不正具
  GOROUTINEをどれくらい動かすかをせいげんするとか
    山ほど動かせるかというとそうでもなくて、GOROUTINEを作ってチャネルを作ってどれくらいつなげらっるかという連取問題がある
     システムが急に遅くなてて、ある時点からスワップを使い始めて、システムが動かなくなった
      ある絵程度動かすと、その時はスワップを使い始めるタイミングでチャネルでメッセージを送るようにした
  やはり\係数セマフォで上限を抑えるのが重要
  簡単にGOROUTINEがつくれるので気が付いたら大量に作ってしまい、ほかのリソースがなくなってしまうということがおおい

Q パッケージ、パッケージと明美恵でいいことがかいてあるとおもう。ぱっけーjのメンバを記述する責任はパッケージ名とメンバ名に等しくでる
プログラミングにおいて名前を付けるのはかなりクリティカル。どうかんがえがあるか
A 命名は非常に難しい。正しくやるのはもっと難しい。
   OGにきて間もないプログラマは安直に命名してしまうし、パッケージの設計は重要
     toriaezuUTIL見入れておくという花気石工っついきゅすあれる
      短い名前で書く甚つに伝わるようにパッケージを設計するとというのが求められる
       仕掛できれば読みやすいパッケージになる
       GOだとC++とかと比較して短い名前になる。意識して書くようにしている
       名前が使われるコンテキストが重要。パッケージ名で就職させえて使うので、その辺のコンテキストを考えて名前を決める日宇町がある。

Q これはと思ったツール、好きなツールは・
A
 うかい
  一番使っているのはGOIMPORT。
   あとプロファイラとか
    GODOCCも便利
  しばた
    GOIMPORT
    あとリネーム 製薬はあるが
     VIMのプラグインでやっている

   GO DOC パラメータ でターミナルで見るというのをよくやっている


おわりに
うかい
 開発初期は ほかの言語のほうがGOよりもわかりやすいが
  大規模になってくるとGOのほうがわかりやすくなってくる
   ほかのところに影響を与えないようにデザインされているため
  またほかのプログラミング言語t比べて複雑な機能がない
    大人数で大規模であyるのに向いていると思う
うかい
 ほんの練習問題にチャレンジしておいても來田
   練習問題はかなり現実的な問題
     ただしパッケージについての説明がない
  読んだらやった気になるのだらおうが、連取問題は解いてみるべき
   科本wお読んだだけで書けるようになるわけではない
    じっしにコードを書いてみないと耳につかない
     練習問題の８．２でFTPサーバを作れというのもある
  GO は徐々に依然と比べてかなり広まってくると思う。おーぷんそーすのものを使って仕事をするとなると、OGでかかれてくるようなケースもふえてくるかも
